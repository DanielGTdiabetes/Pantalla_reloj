#!/usr/bin/env bash
# Pantalla_reloj — autostart minimalista kiosk (1920x480)

# Desactivar blank/DPMS
xset -dpms
xset s off
xset s noblank

# Ocultar cursor (opcional)
command -v unclutter >/dev/null 2>&1 && unclutter -idle 0.1 -root &

# Variables X
export DISPLAY=:0
export XAUTHORITY=/home/dani/.Xauthority

# Rotación de la pantalla: detecta la salida conectada y rota a horizontal (left)
XR_OUT="$(xrandr --query | awk '/ connected/{print $1; exit}')"
if [ -n "$XR_OUT" ]; then
  xrandr --output "$XR_OUT" --rotate left --primary || true
fi

# Pequeña espera para que Nginx/Backend estén listos
sleep 2

# Lanzar Firefox en kiosk apuntando al frontend local
# (usar /usr/local/bin/firefox, que debe ser un symlink a /opt/firefox/firefox)
setsid -f /usr/local/bin/firefox --no-remote --kiosk http://127.0.0.1 &
